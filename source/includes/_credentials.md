# Credentials

## List all credentials

> Sample Request

```http
GET /api/Credentials HTTP/1.1
Host: api.skeddly.com
Authentication: AccessKey <api key>
```

```shell
curl "https://api.skeddly.com/api/Credentials" \
  -H "Authorization: AccessKey <api key>"
```

> Sample Response

```json
[
    {
        "actionIds": [
            "a-00000001"
        ],
        "cloudProviderSubTypeId": "amazon-standard",
        "createdDate": "2016-06-08T14:42:00Z",
        "credentialId": "cred-00000001",
        "credentialType": "amazon-iam-role",
        "externalId": "skeddly-12345678",
        "isUsedForSnsNotifications": false,
        "lastModifiedDate": "2016-06-08T14:42:00Z",
        "lastModifiedBy": "u-00000001",
        "managedInstanceIds": [
            "mi-00000001"
        ],
        "name": "My Credential",
        "roleArn": "arn:aws:iam::123456789012:role/Skeddly",
        "status": "active"
    }
]
```

Retrieves the list of credentials.

### HTTP Request

`GET https://api.skeddly.com/api/Credentials`

### Query Parameters

Parameter | Default | Description
--------- | ------- | -----------
filter.credentialIds |  | A comma-separated list of credential IDs.
filter.isIncludeDeleted | false | True or false.

### Returns

Array of <a href="#credential">Credential</a> objects.

## Retrieves a credential

> Sample Request

```http
GET /api/Credentials/cred-00000001 HTTP/1.1
Host: api.skeddly.com
Authentication: AccessKey <api key>
```

```shell
curl "https://api.skeddly.com/api/Credentials/cred-00000001" \
  -H "Authorization: AccessKey <api key>"
```

> Sample Response

```json
{
    "actionIds": [
        "a-00000001"
    ],
    "cloudProviderSubTypeId": "amazon-standard",
    "createdDate": "2016-06-08T14:42:00Z",
    "credentialId": "cred-00000001",
    "credentialType": "amazon-iam-role",
    "externalId": "skeddly-12345678",
    "isUsedForSnsNotifications": false,
    "lastModifiedDate": "2016-06-08T14:42:00Z",
    "lastModifiedBy": "u-00000001",
    "managedInstanceIds": [
        "mi-00000001"
    ],
    "name": "My Credential",
    "roleArn": "arn:aws:iam::123456789012:role/Skeddly",
    "status": "active"
}
```

Retrieves information for a credential.

### HTTP Request

`GET https://api.skeddly.com/api/Credentials/<id>`

### URL Parameters

Parameter | Description
--------- | -----------
id | ID of the credential.

### Query Parameters

Parameter | Default | Description
--------- | ------- | -----------
filter.isIncludeDeleted | false | True or false.

### Returns

A <a href="#credential">Credential</a> object.

## Create a credential

> Sample Request

```http
POST /api/Credentials HTTP/1.1
Host: api.skeddly.com
Authentication: AccessKey <api key>
Content-Type: application/json

{
	"cloudProviderSubTypeId": "amazon-standard",
    "credentialType": "amazon-iam-role",
    "externalId": "skeddly-12345678",
    "name": "My Credential",
    "roleArn": "arn:aws:iam::123456789012:role/Skeddly"
}
```

```shell
curl -X POST "https://api.skeddly.com/api/Credentials" \
  -H "Authorization: AccessKey <api key>" \
  -d cloudProviderSubTypeId=amazon-standard \
  -d credentialType=amazon-iam-role \
  -d externalId=skeddly-12345678 \
  -d name="My Credential" \
  -d roleArn="arn:aws:iam::123456789012:role/Skeddly"
```

> Sample Response

```json
{
    "cloudProviderSubTypeId": "amazon-standard",
    "createdDate": "2016-06-08T14:42:00Z",
    "credentialId": "cred-00000001",
    "credentialType": "amazon-iam-role",
    "externalId": "skeddly-12345678",
    "isUsedForSnsNotifications": false,
    "lastModifiedDate": "2016-06-08T14:42:00Z",
    "lastModifiedBy": "u-00000001",
    "name": "My Credential",
    "roleArn": "arn:aws:iam::123456789012:role/Skeddly",
    "status": "active"
}
```

Registers a cloud-provider credential to be used.

### HTTP Request

`POST https://api.skeddly.com/api/Credentials/`

### Body

A <a href="#createcredential">CreateCredential</a> object.

<aside class="notice">Important. externalId must have been generated by <a href="#generate-an-amazon-iam-role-external-id">/api/Credentials/GenerateAmazonIamRoleExternalId</a>.</aside>

### Returns

A <a href="#credential">Credential</a> object.

## Modify a credential

> Sample Request

```http
PUT /api/Credentials/cred-00000001 HTTP/1.1
Host: api.skeddly.com
Authentication: AccessKey <api key>
Content-Type: application/json

{
	"cloudProviderSubTypeId": "amazon-standard",
    "externalId": "skeddly-12345678",
    "name": "My Credential",
    "roleArn": "arn:aws:iam::123456789012:role/Skeddly"
}
```

```shell
curl -X PUT "https://api.skeddly.com/api/Credentials/cred-00000001" \
  -H "Authorization: AccessKey <api key>" \
  -d cloudProviderSubTypeId=amazon-standard \
  -d externalId=skeddly-12345678 \
  -d name="My Credential" \
  -d roleArn="arn:aws:iam::123456789012:role/Skeddly"
```

> Sample Response

```json
{
    "cloudProviderSubTypeId": "amazon-standard",
    "createdDate": "2016-06-08T14:42:00Z",
    "credentialId": "cred-00000001",
    "credentialType": "amazon-iam-role",
    "externalId": "skeddly-12345678",
    "isUsedForSnsNotifications": false,
    "lastModifiedDate": "2016-06-08T14:42:00Z",
    "lastModifiedBy": "u-00000001",
    "name": "My Credential",
    "roleArn": "arn:aws:iam::123456789012:role/Skeddly",
    "status": "active"
}
```

Updates a cloud-provider credential.

### HTTP Request

`PUT https://api.skeddly.com/api/Credentials/<id>`

### URL Parameters

Parameter | Description
--------- | -----------
id | ID of the credential.

### Body

A <a href="#modifycredential">ModifyCredential</a> object.

All body parameters are optional. Only properties being modified are required.

<aside class="notice">Important. externalId must have been generated by <a href="#generate-an-amazon-iam-role-external-id">/api/Credentials/GenerateAmazonIamRoleExternalId</a>.</aside>

### Returns

A <a href="#credential">Credential</a> object.

## Delete a credential

> Sample Request

```http
DELETE /api/Credentials/cred-00000001 HTTP/1.1
Host: api.skeddly.com
Authentication: AccessKey <api key>
```

```shell
curl -X DELETE "https://api.skeddly.com/api/Credentials/cred-00000001" \
  -H "Authorization: AccessKey <api key>"
```

Deletes a cloud-provider credential.

### HTTP Request

`DELETE https://api.skeddly.com/api/Credentials/<id>`

### URL Parameters

Parameter | Description
--------- | -----------
id | ID of the credential.

## Generate an Amazon IAM Role External ID

> Sample Request

```http
GET /api/Credentials/GenerateIamRoleExternalId HTTP/1.1
Host: api.skeddly.com
Authentication: AccessKey <api key>
```

```shell
curl "https://api.skeddly.com/api/Credentials/GenerateIamRoleExternalId" \
  -H "Authorization: AccessKey <api key>"
```

> Sample Response

```json
{
	"expiryDate": "2016-06-07T20:21:00Z",
    "externalId": "skeddly-12345678"
}
```

Generates an external ID to be used for an Amazon IAM Role.

### HTTP Request

`GET https://api.skeddly.com/api/Credentials/GenerateIamRoleExternalId`

### Returns

A <a href="#amazoniamroleexternalid">AmazonIamRoleExternalId</a> object.

## Generate an Amazon IAM Policy

> Sample Request

```http
GET /api/Credentials/cred-00000001/IamPolicy HTTP/1.1
Host: api.skeddly.com
Authentication: AccessKey <api key>
```

```shell
curl "https://api.skeddly.com/api/Credentials/cred-00000001/IamPolicy" \
  -H "Authorization: AccessKey <api key>"
```

> Sample Response

```json
"{
	\"Version\": \"2012-10-17\",
    \"Statement\": [
    	{
        	\"Effect\": \"Allow\",
            \"Action\": [
            	\"ec2:DescribeInstances\",
            	\"ec2:StartInstances\"
            ],
            \"Resource\": \"*\"
        }
    ]
}"
```

Generates an Amazon IAM policy document for an Amazon credential.

### HTTP Request

`GET https://api.skeddly.com/api/Credentials/<id>/IamPolicy`

### URL Parameters

Parameter | Description
--------- | -----------
id | ID of the credential.

### Returns

A JSON string containing an IAM policy document.

<aside class="notice">
	The IAM policy document is in JSON format, but it is encased in a JSON string.
   	Deserialize the response body as a JSON string. Then, if required, deserialize 
    the string contents as an Amazon IAM policy document.
</aside>
